<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ResearchOS - Neural Network Interface</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono:wght@400&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Share Tech Mono', monospace; background: #0a0a0a; color: #00ff41; overflow-x: hidden; line-height: 1.4; }
        .grid-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-image: linear-gradient(rgba(0, 255, 65, 0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(0, 255, 65, 0.03) 1px, transparent 1px); background-size: 20px 20px; z-index: -1; }
        .terminal-window { background: rgba(0, 0, 0, 0.9); border: 1px solid #00ff41; margin: 15px; box-shadow: 0 0 20px rgba(0, 255, 65, 0.3); }
        .terminal-header { background: linear-gradient(90deg, #001a00 0%, #003300 100%); color: #00ff41; padding: 8px 12px; font-size: 14px; font-weight: bold; border-bottom: 1px solid #00ff41; display: flex; justify-content: space-between; }
        .terminal-content { padding: 20px; }
        .ascii-header { text-align: center; color: #00ff41; font-size: 14px; margin-bottom: 30px; white-space: pre; text-shadow: 0 0 15px #00ff41, 0 0 25px #00ff41; position: relative; animation: headerPulse 3s ease-in-out infinite; }
        @keyframes headerPulse { 0%, 100% { text-shadow: 0 0 15px #00ff41, 0 0 25px #00ff41, 0 0 35px #00ff41; } 50% { text-shadow: 0 0 25px #00ff41, 0 0 35px #00ff41, 0 0 45px #00ff41; } }
        .brand-subtitle { font-size: 10px; color: #00ffff; text-transform: uppercase; letter-spacing: 4px; margin-top: 10px; text-shadow: 0 0 10px #00ffff; animation: subtitleGlow 2s ease-in-out infinite alternate; }
        @keyframes subtitleGlow { 0% { opacity: 0.7; } 100% { opacity: 1; text-shadow: 0 0 15px #00ffff, 0 0 25px #00ffff; } }
        .spark-line { position: absolute; bottom: -30px; left: 50%; transform: translateX(-50%); width: 600px; height: 20px; overflow: hidden; }
        .spark { position: absolute; width: 2px; background: linear-gradient(to top, #00ff41, #ffffff); animation: spark 3s infinite linear; box-shadow: 0 0 8px #00ff41; }
        @keyframes spark { 0% { left: 0%; height: 2px; opacity: 0; } 10% { opacity: 1; height: 15px; } 50% { height: 8px; } 90% { height: 12px; opacity: 1; } 100% { left: 100%; height: 1px; opacity: 0; } }
        .spark:nth-child(1) { animation-delay: 0s; } .spark:nth-child(2) { animation-delay: 0.5s; } .spark:nth-child(3) { animation-delay: 1s; } .spark:nth-child(4) { animation-delay: 1.5s; } .spark:nth-child(5) { animation-delay: 2s; } .spark:nth-child(6) { animation-delay: 2.5s; }
        .cyber-desktop { min-height: 100vh; padding: 20px; }
        .neural-grid { display: grid; grid-template-columns: 1fr 400px 350px; gap: 20px; height: calc(100vh - 100px); }
        .research-interface { display: flex; flex-direction: column; gap: 20px; }
        .query-input-container { display: flex; flex-direction: column; align-items: center; gap: 15px; margin: 20px 0; }
        .neural-input { width: 100%; max-width: 500px; background: #000000; border: 2px solid #00ff41; color: #00ff41; padding: 12px 15px; font-family: inherit; font-size: 14px; text-align: center; outline: none; text-shadow: 0 0 8px #00ff41; }
        .neural-input::placeholder { color: #004400; font-style: italic; }
        .neural-input:focus { border: 2px solid #00ffff; box-shadow: 0 0 15px rgba(0, 255, 255, 0.5); color: #00ffff; text-shadow: 0 0 12px #00ffff; }
        .execute-btn { background: linear-gradient(45deg, #001a00, #003300); border: 2px solid #00ff41; color: #00ff41; padding: 15px 40px; font-size: 16px; text-transform: uppercase; letter-spacing: 2px; cursor: pointer; font-family: inherit; display: block; margin: 0 auto; }
        .execute-btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .timer-matrix { text-align: center; padding: 20px; border: 1px solid #00ff41; background: radial-gradient(circle, rgba(0, 255, 65, 0.05) 0%, transparent 70%); }
        .timer-display { font-size: 36px; font-weight: bold; color: #ff00ff; margin: 10px 0; text-shadow: 0 0 20px #ff00ff; }
        .timer-label { font-size: 12px; color: #00cc33; text-transform: uppercase; }
        .data-stream { background: #000000; border: 2px solid #00ff41; padding: 15px; height: 300px; overflow-y: auto; font-size: 13px; color: #00ff41; box-shadow: inset 0 0 10px rgba(0, 255, 65, 0.2); }
        .data-content { white-space: pre-wrap; color: #00ff41; text-shadow: 0 0 8px rgba(0, 255, 65, 0.8); font-family: 'Share Tech Mono', monospace; }
        .loading-matrix { text-align: center; color: #00ff41; font-style: italic; padding: 40px; text-shadow: 0 0 10px #00ff41; }
        .console { background: #000000; color: #00ff41; font-size: 11px; padding: 15px; height: 280px; overflow-y: auto; border: 1px solid #00ff41; }
        .console-line { margin-bottom: 3px; }
        .console-success { color: #00ff41; } .console-info { color: #00ccff; } .console-error { color: #ff0040; } .console-warning { color: #ffff00; }
        .source-matrix { border: 1px solid #00cc33; background: rgba(0, 0, 0, 0.9); padding: 15px; height: 200px; overflow-y: auto; }
        .source-node { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid rgba(0, 255, 65, 0.2); font-size: 12px; }
        .source-handle { color: #00ffff; text-shadow: 0 0 5px #00ffff; } .source-influence { color: #00ff41; font-weight: bold; }
        .neural-status { position: fixed; bottom: 0; left: 0; right: 0; height: 50px; background: rgba(0, 0, 0, 0.95); border-top: 2px solid #00ff41; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; font-size: 12px; }
        .status-left { display: flex; align-items: center; }
        .status-brand { color: #00ffff; font-weight: bold; text-transform: uppercase; letter-spacing: 2px; margin-right: 20px; text-shadow: 0 0 10px #00ffff; animation: brandFlicker 4s ease-in-out infinite; }
        @keyframes brandFlicker { 0%, 90%, 100% { opacity: 1; } 95% { opacity: 0.8; } }
        .status-right { display: flex; }
        .status-node { border: 1px solid #00cc33; padding: 5px 15px; margin-right: 10px; background: rgba(0, 255, 65, 0.05); text-transform: uppercase; }
        .knowledge-ball { position: absolute; width: 12px; height: 12px; border-radius: 50%; box-shadow: 0 0 8px currentColor, inset 1px 1px 3px rgba(255, 255, 255, 0.4); z-index: 10; pointer-events: none; transition: all 0.3s ease; }
        .ball-red { background: radial-gradient(circle, #ff6666 0%, #ff0000 50%, #660000 100%); color: #ff0000; }
        .ball-cyan { background: radial-gradient(circle, #66ffff 0%, #00ffff 50%, #006666 100%); color: #00ffff; }
        .ball-yellow { background: radial-gradient(circle, #ffff66 0%, #ffff00 50%, #666600 100%); color: #ffff00; }
        .ball-magenta { background: radial-gradient(circle, #ff66ff 0%, #ff00ff 50%, #660066 100%); color: #ff00ff; }
        .ball-orange { background: radial-gradient(circle, #ffaa66 0%, #ff6600 50%, #663300 100%); color: #ff6600; }
        .ball-green { background: radial-gradient(circle, #66ff66 0%, #00ff00 50%, #006600 100%); color: #00ff00; }
        .ball-blue { background: radial-gradient(circle, #6666ff 0%, #0066ff 50%, #003366 100%); color: #0066ff; }
        @keyframes bounce1 { 0%, 100% { transform: translate(10px, 10px); } 25% { transform: translate(180px, 30px); } 50% { transform: translate(160px, 60px); } 75% { transform: translate(30px, 50px); } }
        @keyframes bounce2 { 0%, 100% { transform: translate(150px, 15px); } 25% { transform: translate(20px, 45px); } 50% { transform: translate(40px, 25px); } 75% { transform: translate(170px, 55px); } }
        @keyframes bounce3 { 0%, 100% { transform: translate(80px, 45px); } 25% { transform: translate(160px, 20px); } 50% { transform: translate(25px, 35px); } 75% { transform: translate(140px, 60px); } }
        @keyframes bounce4 { 0%, 100% { transform: translate(45px, 30px); } 25% { transform: translate(175px, 50px); } 50% { transform: translate(15px, 15px); } 75% { transform: translate(120px, 40px); } }
        @keyframes bounce5 { 0%, 100% { transform: translate(120px, 55px); } 25% { transform: translate(35px, 20px); } 50% { transform: translate(165px, 40px); } 75% { transform: translate(60px, 25px); } }
        @keyframes bounce6 { 0%, 100% { transform: translate(65px, 20px); } 25% { transform: translate(140px, 45px); } 50% { transform: translate(50px, 55px); } 75% { transform: translate(180px, 30px); } }
        @keyframes bounce7 { 0%, 100% { transform: translate(100px, 35px); } 25% { transform: translate(25px, 55px); } 50% { transform: translate(175px, 15px); } 75% { transform: translate(85px, 50px); } }
        .pulse-glow { animation: pulseGlow 2s infinite; }
        @keyframes pulseGlow { 0%, 100% { text-shadow: 0 0 5px #00ff41, 0 0 10px #00ff41; } 50% { text-shadow: 0 0 2px #00ff41, 0 0 5px #00ff41; } }
        .chat-interface { display: flex; flex-direction: column; height: 100%; }
        .chat-messages { background: #000000; border: 2px solid #00ff41; padding: 15px; height: 400px; overflow-y: auto; font-size: 12px; color: #00ff41; margin-bottom: 10px; }
        .chat-message { margin-bottom: 10px; padding: 8px; border-left: 3px solid #00ff41; background: rgba(0, 255, 65, 0.05); }
        .chat-user { border-left-color: #00ffff; background: rgba(0, 255, 255, 0.05); }
        .chat-ai { border-left-color: #ff00ff; background: rgba(255, 0, 255, 0.05); }
        .chat-sender { font-weight: bold; text-transform: uppercase; font-size: 10px; margin-bottom: 4px; }
        .chat-user .chat-sender { color: #00ffff; }
        .chat-ai .chat-sender { color: #ff00ff; }
        .chat-text { line-height: 1.4; }
        .chat-input-area { display: flex; gap: 10px; }
        .chat-input { flex: 1; background: #000000; border: 2px solid #00ff41; color: #00ff41; padding: 10px; font-family: inherit; font-size: 12px; outline: none; }
        .chat-input:focus { border-color: #00ffff; box-shadow: 0 0 10px rgba(0, 255, 255, 0.3); }
        .chat-send { background: linear-gradient(45deg, #001a00, #003300); border: 2px solid #00ff41; color: #00ff41; padding: 10px 20px; font-size: 12px; cursor: pointer; font-family: inherit; text-transform: uppercase; }
        .chat-send:hover { background: linear-gradient(45deg, #003300, #004400); }
        .typing-indicator { color: #666; font-style: italic; padding: 5px 0; }
        @media (max-width: 1200px) { .neural-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="grid-bg"></div>
    <div class="cyber-desktop">
        <div class="ascii-header">
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù  ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë
‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë
‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
            <div class="brand-subtitle">‚óä Autonomous AI Research Network ‚óä</div>
            <div class="spark-line">
                <div class="spark"></div><div class="spark"></div><div class="spark"></div>
                <div class="spark"></div><div class="spark"></div><div class="spark"></div>
            </div>
        </div>
        <div class="neural-grid">
            <div class="research-interface">
                <div class="terminal-window">
                    <div class="terminal-header"><span>üß† NEURAL RESEARCH INTERFACE v2.0.1</span><span>‚óè LIVE</span></div>
                    <div class="terminal-content">
                        <div class="query-input-container">
                            <input type="text" class="neural-input" id="queryInput" placeholder="Enter your neural query... (e.g., AI blockchain research)" maxlength="100">
                            <button class="execute-btn" id="researchBtn">>>> EXECUTE NEURAL QUERY <<<</button>
                        </div>
                        <div class="timer-matrix">
                            <div class="timer-label">NEURAL NETWORK</div>
                            <div class="timer-display pulse-glow" id="timerDisplay">LIVE</div>
                            <div class="timer-label">ICP AGENTS ACTIVE</div>
                            <div id="knowledgeBalls" style="position: relative; width: 100%; height: 100%;"></div>
                        </div>
                    </div>
                </div>
                <div class="terminal-window">
                    <div class="terminal-header"><span>DATA_STREAM.BUFFER</span><span>‚óâ RECEIVING</span></div>
                    <div class="terminal-content">
                        <div class="data-stream" id="dataStream">
                            <div class="loading-matrix">[AWAITING_NEURAL_INPUT]<br>ResearchOS Neural Network Online<br>Enter query to activate ICP canister...</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="neural-monitor">
                <div class="terminal-window">
                    <div class="terminal-header"><span>NEURAL_ACTIVITY.LOG</span><span>‚óé MONITORING</span></div>
                    <div class="terminal-content">
                        <div class="console" id="console">
                            <div class="console-line"><span class="console-info">[INFO]</span> ResearchOS neural network initialized</div>
                            <div class="console-line"><span class="console-success">[OK]</span> ICP canister integration ready</div>
                            <div class="console-line"><span class="console-info">[INFO]</span> Awaiting neural queries...</div>
                        </div>
                    </div>
                </div>
                <div class="terminal-window">
                    <div class="terminal-header"><span>SOURCE_MATRIX.VERIFIED</span><span>‚óà INDEXED</span></div>
                    <div class="terminal-content">
                        <div class="source-matrix" id="sourceMatrix">
                            <div style="text-align: center; color: #666; padding: 30px;">[NEURAL_PATHWAYS_STANDBY]<br>Execute query to activate source nodes...</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="chat-panel">
                <div class="terminal-window">
                    <div class="terminal-header"><span>üí¨ NEURAL CHAT INTERFACE</span><span>‚óâ ACTIVE</span></div>
                    <div class="terminal-content">
                        <div class="chat-interface">
                            <div class="chat-messages" id="chatMessages">
                                <div class="chat-message chat-ai">
                                    <div class="chat-sender">ResearchOS_AI</div>
                                    <div class="chat-text">Neural chat interface initialized. I can help with research queries, system analysis, and knowledge synthesis. What would you like to explore?</div>
                                </div>
                            </div>
                            <div class="chat-input-area">
                                <input type="text" class="chat-input" id="chatInput" placeholder="Ask me anything..." maxlength="500">
                                <button class="chat-send" id="chatSend">SEND</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="neural-status">
        <div class="status-left">
            <div class="status-brand">‚óä ResearchOS Neural Network ‚óä</div>
        </div>
        <div class="status-right">
            <div class="status-node">SYSTEM_ONLINE</div>
            <div class="status-node" id="connectionStatus">SERVER_READY</div>
            <div class="status-node" id="agentStatus">AGENTS_STANDBY</div>
            <div class="status-node" id="timeStatus">ICP_LIVE</div>
        </div>
    </div>
    <script>
        class ResearchOS {
            constructor() {
                this.isProcessing = false;
                this.knowledgeSources = new Set();
                this.ballColors = ['ball-red', 'ball-cyan', 'ball-yellow', 'ball-magenta', 'ball-orange', 'ball-green', 'ball-blue'];
                this.chatResponses = [
                    "Analyzing neural pathways for optimal research vectors...",
                    "Cross-referencing knowledge matrices with ICP blockchain data...",
                    "Synthesizing information from distributed AI agents...",
                    "Processing query through quantum neural networks...",
                    "Accessing deep learning knowledge repositories...",
                    "Correlating data patterns across multiple source vectors...",
                    "Executing advanced semantic analysis protocols...",
                    "Interfacing with autonomous research algorithms..."
                ];
                this.initEventListeners();
                this.checkConnection();
            }
            async checkConnection() {
                try {
                    const response = await fetch('/api/health');
                    const data = await response.json();
                    this.addConsoleEntry('Backend connection established', 'success');
                    this.addConsoleEntry(data.message, 'info');
                } catch (error) {
                    this.addConsoleEntry('Backend connection failed - Running in demo mode', 'warning');
                }
            }
            initEventListeners() {
                const queryInput = document.getElementById('queryInput');
                const researchBtn = document.getElementById('researchBtn');
                const chatInput = document.getElementById('chatInput');
                const chatSend = document.getElementById('chatSend');
                
                researchBtn.addEventListener('click', () => this.executeQuery());
                queryInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.executeQuery();
                });
                queryInput.addEventListener('focus', () => {
                    this.addConsoleEntry('Neural input interface activated', 'info');
                });
                
                chatSend.addEventListener('click', () => this.sendChatMessage());
                chatInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.sendChatMessage();
                });
            }
            async executeQuery() {
                if (this.isProcessing) return;
                const queryInput = document.getElementById('queryInput');
                const userQuery = queryInput.value.trim();
                if (!userQuery) {
                    this.addConsoleEntry('Neural query cannot be empty', 'warning');
                    queryInput.focus();
                    return;
                }
                this.isProcessing = true;
                const btn = document.getElementById('researchBtn');
                btn.disabled = true;
                btn.textContent = '>>> PROCESSING <<<';
                btn.classList.add('pulse-glow');
                document.getElementById('agentStatus').textContent = 'AGENTS_ACTIVE';
                try {
                    this.addConsoleEntry('Neural query: "' + userQuery + '"', 'info');
                    this.addConsoleEntry('Connecting to ICP canister...', 'info');
                    
                    // Demo mode simulation
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    
                    const mockResult = {
                        success: true,
                        data: {
                            content: `[DEMO_MODE] Processing "${userQuery}"...\n\nNeural analysis complete. Topic synthesis activated.\nKnowledge vectors aligned for optimal information retrieval.\nResearch pathways established for continuous monitoring.`,
                            sources: [
                                { handle: 'ArXiv', neural_id: 'ax_001', influence: 92 },
                                { handle: 'TechCrunch', neural_id: 'tc_002', influence: 78 },
                                { handle: 'Nature', neural_id: 'nt_003', influence: 95 }
                            ],
                            logs: [
                                { agent: 'QueryAgent', message: 'Query processed successfully', log_type: 'success' },
                                { agent: 'SourceAgent', message: 'Knowledge sources verified', log_type: 'info' }
                            ]
                        }
                    };
                    
                    this.addConsoleEntry('Data acquisition complete', 'success');
                    this.displayResults(mockResult.data);
                    queryInput.value = '';
                    
                } catch (error) {
                    this.addConsoleEntry('Query failed: ' + error.message, 'error');
                } finally {
                    btn.disabled = false;
                    btn.textContent = '>>> EXECUTE NEURAL QUERY <<<';
                    btn.classList.remove('pulse-glow');
                    this.isProcessing = false;
                    document.getElementById('agentStatus').textContent = 'AGENTS_READY';
                }
            }
            displayResults(data) {
                const dataStream = document.getElementById('dataStream');
                const formatted = this.formatContent(data.content);
                dataStream.innerHTML = '<div class="data-content">' + formatted + '</div>';
                const sourceMatrix = document.getElementById('sourceMatrix');
                sourceMatrix.innerHTML = data.sources.map(source => 
                    '<div class="source-node"><div><span class="source-handle">' + source.handle + '</span><div style="font-size: 10px; color: #666;">' + source.neural_id + '</div></div><span class="source-influence">' + source.influence + '%</span></div>'
                ).join('');
                
                // Add knowledge balls for new sources
                data.sources.forEach(source => {
                    if (!this.knowledgeSources.has(source.handle)) {
                        this.knowledgeSources.add(source.handle);
                        this.addKnowledgeBall(source.handle);
                    }
                });
                
                data.logs.forEach(log => {
                    this.addConsoleEntry(log.agent + ': ' + log.message, log.log_type);
                });
            }
            
            addKnowledgeBall(sourceName) {
                const ballContainer = document.getElementById('knowledgeBalls');
                const ball = document.createElement('div');
                const colorIndex = (this.knowledgeSources.size - 1) % this.ballColors.length;
                const animationIndex = (this.knowledgeSources.size - 1) % 7 + 1;
                
                ball.className = `knowledge-ball ${this.ballColors[colorIndex]}`;
                ball.style.animation = `bounce${animationIndex} ${5 + Math.random() * 3}s infinite linear`;
                ball.title = `Knowledge Source: ${sourceName}`;
                
                ballContainer.appendChild(ball);
                
                this.addConsoleEntry(`New knowledge source activated: ${sourceName}`, 'success');
            }
            
            sendChatMessage() {
                const chatInput = document.getElementById('chatInput');
                const message = chatInput.value.trim();
                if (!message) return;
                
                this.addChatMessage('USER', message, 'chat-user');
                chatInput.value = '';
                
                // Show typing indicator
                this.addTypingIndicator();
                
                // Simulate AI response after 1-3 seconds
                setTimeout(() => {
                    this.removeTypingIndicator();
                    const response = this.generateChatResponse(message);
                    this.addChatMessage('ResearchOS_AI', response, 'chat-ai');
                    this.addConsoleEntry('Chat message processed', 'info');
                }, 1000 + Math.random() * 2000);
            }
            
            addChatMessage(sender, text, cssClass) {
                const chatMessages = document.getElementById('chatMessages');
                const messageDiv = document.createElement('div');
                messageDiv.className = `chat-message ${cssClass}`;
                messageDiv.innerHTML = `
                    <div class="chat-sender">${sender}</div>
                    <div class="chat-text">${text}</div>
                `;
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            addTypingIndicator() {
                const chatMessages = document.getElementById('chatMessages');
                const typingDiv = document.createElement('div');
                typingDiv.className = 'typing-indicator';
                typingDiv.id = 'typingIndicator';
                typingDiv.textContent = 'ResearchOS_AI is analyzing...';
                chatMessages.appendChild(typingDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            removeTypingIndicator() {
                const indicator = document.getElementById('typingIndicator');
                if (indicator) indicator.remove();
            }
            
            generateChatResponse(userMessage) {
                const lowerMessage = userMessage.toLowerCase();
                
                if (lowerMessage.includes('hello') || lowerMessage.includes('hi')) {
                    return "Greetings! I'm the ResearchOS neural network. I can assist with research, data analysis, and knowledge synthesis. How can I help optimize your research today?";
                }
                
                if (lowerMessage.includes('research') || lowerMessage.includes('data')) {
                    return this.chatResponses[Math.floor(Math.random() * this.chatResponses.length)] + " Query processed. Would you like me to initiate a full neural search?";
                }
                
                if (lowerMessage.includes('help')) {
                    return "I can help with: üîπ Research queries üîπ Data analysis üîπ Knowledge synthesis üîπ Neural network operations. Try asking me about a topic or use the main research interface for deep analysis.";
                }
                
                if (lowerMessage.includes('icp') || lowerMessage.includes('blockchain')) {
                    return "ICP blockchain integration active. The ResearchOS network leverages Internet Computer Protocol for decentralized AI coordination and persistent knowledge storage. Autonomous agents operating at optimal efficiency.";
                }
                
                // Default responses
                const responses = [
                    `Interesting query about "${userMessage}". Let me process this through the neural matrix...`,
                    `Analyzing "${userMessage}" across multiple knowledge vectors. Cross-referencing with research databases...`,
                    `Neural pathways activated for "${userMessage}". Synthesizing information from distributed sources...`,
                    `Processing "${userMessage}" through quantum analysis protocols. Results incoming...`
                ];
                
                return responses[Math.floor(Math.random() * responses.length)];
            }
            formatContent(content) {
                return content.split('\n').map((line, i) => {
                    if (line.trim()) {
                        const priority = i < 2 ? '[PRIORITY_ALPHA]' : '[PRIORITY_BETA]';
                        return priority + ' ' + line.trim();
                    }
                    return line;
                }).join('\n');
            }
            addConsoleEntry(text, type = 'info') {
                const console = document.getElementById('console');
                const line = document.createElement('div');
                line.className = 'console-line';
                const timestamp = new Date().toLocaleTimeString();
                const prefixes = { success: '[OK]', error: '[ERR]', warning: '[WARN]', info: '[INFO]' };
                const prefix = prefixes[type] || '[INFO]';
                line.innerHTML = '<span class="console-' + type + '">' + prefix + '</span> [' + timestamp + '] ' + text;
                console.appendChild(line);
                console.scrollTop = console.scrollHeight;
                const lines = console.querySelectorAll('.console-line');
                if (lines.length > 50) lines[0].remove();
            }
        }
        document.addEventListener('DOMContentLoaded', () => {
            new ResearchOS();
        });
    </script>
</body>
</html>
